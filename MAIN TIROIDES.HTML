<!DOCTYPE html>
<html lang="es" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Infograf√≠a: Hipotiroidismo ‚Äì An√°lisis Profundo con Consejos IA</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #F1F5F9; /* bg-slate-100 */
            color: #1E293B; /* text-slate-800 */
        }
        .chart-container {
            position: relative;
            width: 100%;
            margin-left: auto;
            margin-right: auto;
        }
        .section-title {
            font-size: 1.875rem; /* text-3xl */
            md:font-size: 2.25rem; /* md:text-4xl */
            font-weight: 700; /* font-bold */
            color: #FF7F50; /* Coral - Energetic & Playful Palette */
            margin-bottom: 1.5rem; /* mb-6 */
            text-align: center;
        }
        .card {
            background-color: white;
            border-radius: 0.5rem; /* rounded-lg */
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06); /* shadow-md */
            padding: 1rem; /* p-4 */
            md:padding: 1.5rem; /* md:p-6 */
            margin-bottom: 1.5rem; /* mb-6 */
        }
        .stat-number {
            font-size: 2.5rem; /* Adjusted for mobile */
            md:font-size: 3rem; /* md:text-5xl */
            font-weight: 700; /* font-bold */
            color: #008080; /* Teal - Energetic & Playful Palette */
        }
        .icon-placeholder {
            font-size: 2rem; /* Adjusted for mobile */
            md:font-size: 2.5rem;
            margin-right: 0.75rem;
            color: #FF7F50; /* Coral */
        }
        .sticky-nav a {
            color: #008080; /* Teal */
            padding: 0.5rem 0.5rem; /* Adjusted padding */
            font-size: 0.8rem; /* Adjusted font size */
            sm:font-size: 1rem;
            sm:padding: 0.5rem 1rem;
            border-radius: 0.375rem; /* rounded-md */
            transition: background-color 0.3s ease, color 0.3s ease;
        }
        .sticky-nav a:hover {
            background-color: #FFD700; /* Gold/Yellow */
            color: #333333;
        }
        .scroll-mt-24 {
            scroll-margin-top: 6rem; /* Adjust based on sticky header height */
        }
        .gemini-response-container {
            margin-top: 1rem;
            padding: 1rem;
            background-color: #E0F2F7; /* Light Teal Background */
            border-left: 4px solid #008080; /* Teal border */
            border-radius: 0.375rem;
            color: #1E293B;
            font-size: 0.875rem; /* text-sm */
        }
        .gemini-response-container ul {
            list-style-type: disc;
            margin-left: 1.5rem;
            padding-left: 0.5rem;
            margin-bottom: 0.75rem;
        }
        .gemini-response-container p {
            margin-bottom: 0.75rem;
        }
         .gemini-response-container li {
            margin-bottom: 0.5rem;
        }
        .loader {
            border: 4px solid #f3f3f3; /* Light grey */
            border-top: 4px solid #008080; /* Teal */
            border-radius: 50%;
            width: 30px;
            height: 30px;
            animation: spin 1s linear infinite;
            margin: 1rem auto;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
</head>
<body>
    <header class="bg-white shadow-md sticky top-0 z-50">
        <nav class="container mx-auto px-4 sm:px-6 py-3">
            <ul class="flex flex-wrap justify-center items-center space-x-2 sm:space-x-4 sticky-nav">
                <li><a href="#introduccion">Introducci√≥n</a></li>
                <li><a href="#impacto">Impacto</a></li>
                <li><a href="#causas">Causas</a></li>
                <li><a href="#bienestar">Bienestar</a></li>
                <li><a href="#sintomas-especificos">S√≠ntomas</a></li>
                <li><a href="#consideraciones">Consideraciones</a></li>
            </ul>
        </nav>
    </header>

    <main class="container mx-auto p-4 md:p-8">

        <section id="introduccion" class="mb-16 scroll-mt-24">
            <h1 class="text-3xl md:text-5xl font-bold text-center mb-4" style="color: #FF7F50;">Hipotiroidismo: Un An√°lisis Profundo</h1>
            <p class="text-base md:text-lg text-center text-slate-700 mb-8">Una mirada integral a la deficiencia hormonal tiroidea, su prevalencia, s√≠ntomas y diagn√≥stico, basada en la investigaci√≥n actual.</p>
            
            <div class="grid md:grid-cols-2 gap-8 items-center">
                <div class="card">
                    <h3 class="text-xl md:text-2xl font-semibold mb-3" style="color: #008080;">¬øQu√© es el Hipotiroidismo?</h3>
                    <p class="mb-4 text-sm md:text-base">El hipotiroidismo es una condici√≥n endocrina caracterizada por una producci√≥n insuficiente de hormonas por parte de la gl√°ndula tiroides. Estas hormonas, tiroxina (T4) y triyodotironina (T3), son cruciales para regular el metabolismo, es decir, la manera en que cada c√©lula del organismo utiliza la energ√≠a. Una deficiencia hormonal ralentiza m√∫ltiples funciones corporales.</p>
                    <p class="text-sm md:text-base">Los s√≠ntomas suelen desarrollarse lentamente e incluyen fatiga, aumento de peso, intolerancia al fr√≠o, dolores musculares y articulares, piel y cabello secos, estre√±imiento y dificultades cognitivas.</p>
                </div>
                <div class="card text-center">
                    <h3 class="text-xl md:text-2xl font-semibold mb-3" style="color: #008080;">Prevalencia Destacada</h3>
                    <div class="mb-4">
                        <p class="stat-number">~5-11%</p>
                        <p class="text-slate-600 text-sm md:text-base">de la poblaci√≥n afectada en diversas regiones.</p>
                    </div>
                    <p class="text-slate-600 mb-2 text-sm md:text-base">M√°s com√∫n en <span class="font-semibold" style="color: #FF69B4;">mujeres</span> y personas <span class="font-semibold" style="color: #FF69B4;">mayores de 50 a√±os</span>.</p>
                    <div class="chart-container h-56 sm:h-64 md:h-72 max-w-sm mx-auto">
                        <canvas id="prevalenciaChart"></canvas>
                    </div>
                    <p class="mt-4 text-sm text-slate-500">El diagn√≥stico se basa en an√°lisis de sangre (TSH y T4 libre).</p>
                </div>
            </div>
        </section>

        <section id="impacto" class="mb-16 scroll-mt-24">
            <h2 class="section-title">Impacto Fisiol√≥gico Directo</h2>
            <p class="text-center text-slate-700 mb-8 text-sm md:text-base">La deficiencia de hormonas tiroideas afecta la funci√≥n celular b√°sica en pr√°cticamente todos los tejidos y √≥rganos.</p>
            <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-6">
                 <div class="card text-sm md:text-base">
                    <h4 class="text-lg md:text-xl font-semibold mb-2 flex items-center"><span class="icon-placeholder">‚ö°</span>Metabolismo y Mitocondrias</h4>
                    <p>Ralentizaci√≥n general del metabolismo basal. Disfunci√≥n mitocondrial, explicando la fatiga profunda.</p>
                </div>
                <div class="card text-sm md:text-base">
                    <h4 class="text-lg md:text-xl font-semibold mb-2 flex items-center"><span class="icon-placeholder">‚ù§Ô∏è</span>Sistema Cardiovascular</h4>
                    <p>Bradicardia (ritmo lento), aumento de presi√≥n diast√≥lica, riesgo de enfermedad card√≠aca y colesterol LDL elevado.</p>
                </div>
                <div class="card text-sm md:text-base">
                    <h4 class="text-lg md:text-xl font-semibold mb-2 flex items-center"><span class="icon-placeholder">üß†</span>Sistema Nervioso</h4>
                    <p>Mala memoria, "niebla cerebral", dificultad de concentraci√≥n, depresi√≥n y ansiedad. Neuropat√≠a perif√©rica.</p>
                </div>
                <div class="card text-sm md:text-base">
                    <h4 class="text-lg md:text-xl font-semibold mb-2 flex items-center"><span class="icon-placeholder">üí™</span>Sistema Musculoesquel√©tico</h4>
                    <p>Dolor y rigidez muscular/articular, debilidad, calambres. Posible reducci√≥n del recambio √≥seo.</p>
                </div>
                <div class="card text-sm md:text-base">
                    <h4 class="text-lg md:text-xl font-semibold mb-2 flex items-center"><span class="icon-placeholder">üíß</span>Piel y Tejido Conectivo</h4>
                    <p>Piel seca, √°spera, p√°lida. Cabello seco, ralo, quebradizo. U√±as fr√°giles. Mixedema en casos severos.</p>
                </div>
                <div class="card text-sm md:text-base">
                    <h4 class="text-lg md:text-xl font-semibold mb-2 flex items-center"><span class="icon-placeholder">üçé</span>Sistema Gastrointestinal</h4>
                    <p>Ralentizaci√≥n de la motilidad, resultando en estre√±imiento frecuente. Disminuci√≥n del gusto/olfato.</p>
                </div>
            </div>
        </section>

        <section id="causas" class="mb-16 scroll-mt-24">
            <h2 class="section-title">Principales Causas</h2>
            <p class="text-center text-slate-700 mb-8 text-sm md:text-base">Un abordaje multifactorial que incluye factores autoinmunes, nutricionales, ambientales e iatrog√©nicos.</p>
            <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-6">
                <div class="card lg:col-span-2">
                    <h3 class="text-xl md:text-2xl font-semibold mb-3" style="color: #008080;">Tiroiditis de Hashimoto</h3>
                    <p class="mb-2 text-sm md:text-base">La causa m√°s com√∫n en √°reas con suficiente yodo. Es un trastorno autoinmune donde el cuerpo ataca la tiroides, da√±√°ndola progresivamente.</p>
                    <p class="text-xs md:text-sm text-slate-600">Factores: Gen√©tica, infecciones virales, estr√©s, exceso de yodo en susceptibles.</p>
                    <div class="mt-4 p-3 bg-amber-100 rounded-lg">
                        <p class="text-sm text-amber-800"><span class="font-semibold">Importante:</span> Se asocia con mayor riesgo de otras enfermedades autoinmunes (celiaqu√≠a, diabetes tipo 1).</p>
                    </div>
                </div>
                 <div class="card">
                    <h3 class="text-xl md:text-2xl font-semibold mb-3" style="color: #008080;">Proporci√≥n de Causas</h3>
                     <div class="chart-container h-64 sm:h-72 md:h-80 max-w-sm mx-auto">
                        <canvas id="causasChart"></canvas>
                    </div>
                    <p class="mt-2 text-xs text-center text-slate-500">Representaci√≥n ilustrativa de la contribuci√≥n de las causas comunes.</p>
                </div>
                <div class="card text-sm md:text-base">
                    <h3 class="text-lg md:text-xl font-semibold mb-3" style="color: #008080;">Deficiencias Nutricionales</h3>
                    <ul class="list-disc list-inside space-y-1">
                        <li><span class="font-semibold">Yodo:</span> Componente esencial.</li>
                        <li><span class="font-semibold">Selenio:</span> Conversi√≥n T4-T3.</li>
                        <li><span class="font-semibold">Hierro:</span> Enzima TPO.</li>
                        <li><span class="font-semibold">Zinc:</span> S√≠ntesis/Receptor.</li>
                        <li><span class="font-semibold">Vitamina D:</span> Inmunidad.</li>
                        <li><span class="font-semibold">Vitamina B12:</span> Energ√≠a/Nervios.</li>
                    </ul>
                </div>
                <div class="card text-sm md:text-base">
                    <h3 class="text-lg md:text-xl font-semibold mb-3" style="color: #008080;">Factores Ambientales</h3>
                    <p>Disruptores Endocrinos (BPA, ftalatos), pesticidas, metales pesados.</p>
                </div>
                <div class="card text-sm md:text-base">
                    <h3 class="text-lg md:text-xl font-semibold mb-3" style="color: #008080;">Causas Iatrog√©nicas</h3>
                    <ul class="list-disc list-inside space-y-1">
                        <li>Cirug√≠a tiroides.</li>
                        <li>Yodo radiactivo (I-131).</li>
                        <li>Radioterapia cuello/cabeza.</li>
                        <li>Medicamentos.</li>
                    </ul>
                </div>
            </div>
        </section>

        <section id="bienestar" class="mb-16 scroll-mt-24">
            <h2 class="section-title">Recuperaci√≥n y Bienestar</h2>
            <p class="text-center text-slate-700 mb-8 text-sm md:text-base">Estrategias integrativas m√°s all√° de la levotiroxina para abordar s√≠ntomas persistentes.</p>
            
            <div class="card mb-8">
                <h3 class="text-xl md:text-2xl font-semibold mb-4 text-center" style="color: #008080;">Pilares del Bienestar</h3>
                <div class="flex flex-wrap justify-around items-center p-4 space-y-4 md:space-y-0 md:space-x-4 rounded-lg border-2 border-dashed border-teal-500">
                    <div class="text-center p-2">
                        <span class="text-3xl md:text-4xl">üíä</span>
                        <p class="mt-1 font-semibold text-xs md:text-sm">Optimizar T3</p>
                    </div>
                    <div class="text-center p-2">
                        <span class="text-3xl md:text-4xl">üîã</span>
                        <p class="mt-1 font-semibold text-xs md:text-sm">Salud Mitocondrial</p>
                    </div>
                    <div class="text-center p-2">
                        <span class="text-3xl md:text-4xl">üßò</span>
                        <p class="mt-1 font-semibold text-xs md:text-sm">Manejo Estr√©s</p>
                    </div>
                     <div class="text-center p-2">
                        <span class="text-3xl md:text-4xl">üò¥</span>
                        <p class="mt-1 font-semibold text-xs md:text-sm">Sue√±o Reparador</p>
                    </div>
                    <div class="text-center p-2">
                        <span class="text-3xl md:text-4xl">üèÉ‚Äç‚ôÄÔ∏è</span>
                        <p class="mt-1 font-semibold text-xs md:text-sm">Ejercicio Adecuado</p>
                    </div>
                </div>
            </div>

            <div class="grid md:grid-cols-2 gap-8">
                <div class="card">
                    <h3 class="text-lg md:text-xl font-semibold mb-3" style="color: #008080;">Salud Gastrointestinal</h3>
                    <p class="mb-2 text-sm md:text-base">Clave, especialmente en Hashimoto. Dieta antiinflamatoria.</p>
                    <div class="mb-3 p-3 bg-emerald-50 rounded-lg text-xs md:text-sm">
                        <h5 class="font-semibold text-emerald-700">Recomendados:</h5>
                        <ul class="list-disc list-inside text-emerald-600">
                            <li>Pescados grasos, nueces Brasil.</li>
                            <li>Verduras hoja verde, bayas.</li>
                            <li>Aceite oliva, aguacate.</li>
                            <li>Fermentados (tolerados).</li>
                        </ul>
                    </div>
                    <div class="p-3 bg-red-50 rounded-lg text-xs md:text-sm">
                        <h5 class="font-semibold text-red-700">A Considerar/Moderar:</h5>
                        <ul class="list-disc list-inside text-red-600">
                            <li>Goitr√≥genos crudos.</li>
                            <li>Soja (con L-T4).</li>
                            <li>Gluten y l√°cteos (sensibilidad).</li>
                            <li>Procesados, az√∫cares.</li>
                        </ul>
                    </div>
                    <p class="mt-3 text-xs md:text-sm">Investigar SIBO e hipoclorhidria si persisten s√≠ntomas digestivos.</p>
                </div>

                <div class="card">
                    <h3 class="text-lg md:text-xl font-semibold mb-3" style="color: #008080;">Micronutrientes Clave</h3>
                    <p class="mb-3 text-sm md:text-base">Corregir deficiencias es vital.</p>
                     <div class="chart-container h-64 sm:h-72 md:h-80 max-w-md mx-auto">
                        <canvas id="micronutrientesChart"></canvas>
                    </div>
                    <p class="mt-2 text-xs text-center text-slate-500">Importancia relativa.</p>
                </div>
            </div>

            <div class="card mt-8 md:col-span-2">
                <h3 class="text-xl md:text-2xl font-semibold mb-4 text-center" style="color: #FF7F50;">‚ú® Consejos de Bienestar Potenciados por IA</h3>
                <p class="text-center text-slate-600 mb-4 text-sm md:text-base">Selecciona tus principales preocupaciones para recibir sugerencias generales de dieta y estilo de vida. Esta herramienta es informativa y no reemplaza el consejo m√©dico.</p>
                
                <div class="mb-4 space-y-2 text-sm md:text-base">
                    <label class="block text-slate-700 font-semibold mb-1">Mis principales preocupaciones son:</label>
                    <div>
                        <input type="checkbox" id="concernFatiga" name="concerns" value="Fatiga Persistente" class="mr-2">
                        <label for="concernFatiga">Fatiga Persistente</label>
                    </div>
                    <div>
                        <input type="checkbox" id="concernDigestivos" name="concerns" value="Problemas Digestivos" class="mr-2">
                        <label for="concernDigestivos">Problemas Digestivos (hinchaz√≥n, estre√±imiento)</label>
                    </div>
                    <div>
                        <input type="checkbox" id="concernNiebla" name="concerns" value="Niebla Mental" class="mr-2">
                        <label for="concernNiebla">Niebla Mental / Dificultad de Concentraci√≥n</label>
                    </div>
                    <div>
                        <input type="checkbox" id="concernEstres" name="concerns" value="Manejo del Estr√©s y √Ånimo" class="mr-2">
                        <label for="concernEstres">Manejo del Estr√©s y √Ånimo Bajo</label>
                    </div>
                     <div>
                        <input type="checkbox" id="concernPielCabello" name="concerns" value="Piel y Cabello Secos" class="mr-2">
                        <label for="concernPielCabello">Piel y Cabello Secos</label>
                    </div>
                </div>

                <button id="getGeminiAdviceBtn" class="w-full bg-teal-500 hover:bg-teal-600 text-white font-bold py-2 px-4 rounded-lg transition duration-300 ease-in-out">
                    ‚ú® Obtener Consejos con IA
                </button>

                <div id="geminiLoader" class="loader hidden my-4"></div>
                <div id="geminiResponse" class="gemini-response-container hidden">
                    <p>Aqu√≠ se mostrar√°n los consejos generados por la IA...</p>
                </div>
            </div>
            </section>

        <section id="sintomas-especificos" class="mb-16 scroll-mt-24">
            <h2 class="section-title">Conexi√≥n de S√≠ntomas Espec√≠ficos</h2>
            <p class="text-center text-slate-700 mb-8 text-sm md:text-base">An√°lisis de c√≥mo ciertos s√≠ntomas comunes se relacionan con el hipotiroidismo.</p>
            <div class="grid md:grid-cols-2 gap-6">
                <div class="card text-sm md:text-base">
                    <h4 class="text-lg md:text-xl font-semibold mb-2 flex items-center"><span class="icon-placeholder">ü§¢</span>Reflujo G√°strico (ERGE)</h4>
                    <p>Frecuente. Mecanismos: enlentecimiento g√°strico, hipoclorhidria, SIBO. Abordaje: optimizar T4/T3, tratar causas, dieta.</p>
                </div>
                 <div class="card text-sm md:text-base">
                    <h4 class="text-lg md:text-xl font-semibold mb-2 flex items-center"><span class="icon-placeholder">ü¶µ</span>Dolor Piernas/Calambres</h4>
                    <p>Com√∫n. Mecanismos: miopat√≠a, acumulaci√≥n mucopolisac√°ridos, deficiencias. Abordaje: optimizar T4/T3, suplementar, ejercicio.</p>
                </div>
                <div class="card text-sm md:text-base">
                    <h4 class="text-lg md:text-xl font-semibold mb-2 flex items-center"><span class="icon-placeholder">üñêÔ∏è</span>Problemas Tendinosos (STC)</h4>
                    <p>Frecuente (T√∫nel Carpiano). Mecanismo: acumulaci√≥n mucopolisac√°ridos, compresi√≥n. Abordaje: optimizar T4/T3, fisio.</p>
                </div>
                <div class="card text-sm md:text-base">
                    <h4 class="text-lg md:text-xl font-semibold mb-2 flex items-center"><span class="icon-placeholder">ü§Ø</span>Niebla Cerebral/Memoria</h4>
                    <p>Com√∫n. Mecanismos: ‚Üì metabolismo cerebral, neuroinflamaci√≥n, deficiencias. Abordaje: optimizar T4/T3, corregir deficiencias.</p>
                </div>
            </div>
        </section>

        <section id="consideraciones" class="mb-12 scroll-mt-24">
            <h2 class="section-title">Consideraciones Adicionales</h2>
            <div class="card text-sm md:text-base">
                <h3 class="text-lg md:text-xl font-semibold mb-3" style="color: #008080;">Individualizaci√≥n y Colaboraci√≥n Profesional</h3>
                <p class="mb-3">El manejo del hipotiroidismo requiere un enfoque individualizado. La dosis de L-T4, dieta y suplementos deben ajustarse a cada paciente.</p>
                <p class="mb-3">La persistencia de s√≠ntomas con TSH normalizada requiere una colaboraci√≥n estrecha con profesionales para explorar otras causas.</p>
                
                <div class="mt-6 p-4 border-l-4 border-yellow-500 bg-yellow-100 text-yellow-800 rounded-md">
                    <h4 class="font-bold text-lg mb-2">‚ö†Ô∏è Advertencia Importante</h4>
                    <p class="text-sm">Esta infograf√≠a tiene fines educativos. No sustituye la consulta m√©dica profesional. Cualquier cambio en su tratamiento debe ser supervisado por un m√©dico.</p>
                </div>
            </div>
        </section>
    </main>

    <footer class="text-center p-6 bg-slate-800 text-slate-300 text-xs md:text-sm">
        <p>&copy; 2025 Infograf√≠a sobre Hipotiroidismo. Basado en investigaci√≥n integral.</p>
        <p>Consulte siempre a un profesional m√©dico para obtener asesoramiento personalizado.</p>
    </footer>

    <script>
        function processLabel(label, maxLength = 14) { // Reduced maxLength
            if (typeof label !== 'string') {
                return label; 
            }
            if (label.length <= maxLength) {
                return label;
            }
            const words = label.split(' ');
            const lines = [];
            let currentLine = '';
            for (const word of words) {
                if ((currentLine + word).length > maxLength && currentLine.length > 0) {
                    lines.push(currentLine.trim());
                    currentLine = word + ' ';
                } else {
                    currentLine += word + ' ';
                }
            }
            lines.push(currentLine.trim());
            return lines.filter(line => line.length > 0);
        }

        const tooltipTitleCallback = function(tooltipItems) {
            const item = tooltipItems[0];
            if (!item) return '';
            let label = item.chart.data.labels[item.dataIndex];
            if (Array.isArray(label)) {
                return label.join(' ');
            }
            return label;
        };
        
        const sharedChartOptions = {
            responsive: true,
            maintainAspectRatio: false,
            plugins: {
                legend: {
                    position: 'bottom',
                    labels: {
                        font: { size: 9 }, // Reduced font size
                        boxWidth: 15, // Reduced box width
                        padding: 10 // Reduced padding
                    }
                },
                tooltip: {
                    callbacks: {
                        title: tooltipTitleCallback
                    },
                    bodyFont: { size: 9 },
                    titleFont: { size: 11 }
                }
            }
        };

        document.addEventListener('DOMContentLoaded', () => {
            try {
                const prevalenciaCtx = document.getElementById('prevalenciaChart');
                if (prevalenciaCtx) {
                    new Chart(prevalenciaCtx, {
                        type: 'doughnut',
                        data: {
                            labels: [processLabel('Personas con Hipotiroidismo (Estimado)', 14), processLabel('Resto de la Poblaci√≥n (Estimado)', 14)],
                            datasets: [{
                                label: 'Prevalencia Estimada',
                                data: [8, 92], 
                                backgroundColor: ['#FF7F50', '#ADD8E6'],
                                borderColor: ['#FFFFFF', '#FFFFFF'],
                                borderWidth: 2
                            }]
                        },
                        options: { ...sharedChartOptions }
                    });
                }

                const causasCtx = document.getElementById('causasChart');
                if (causasCtx) {
                    new Chart(causasCtx, {
                        type: 'pie',
                        data: {
                            labels: [processLabel('Hashimoto', 14), processLabel('Def. Yodo', 14), processLabel('Iatrog√©nicas', 14), processLabel('Otras', 14)],
                            datasets: [{
                                label: 'Distribuci√≥n de Causas Comunes',
                                data: [60, 15, 15, 10], 
                                backgroundColor: ['#FF7F50', '#008080', '#FFD700', '#FF69B4'],
                                borderColor: ['#FFFFFF', '#FFFFFF', '#FFFFFF', '#FFFFFF'],
                                borderWidth: 2
                            }]
                        },
                        options: { ...sharedChartOptions }
                    });
                }
                
                const micronutrientesCtx = document.getElementById('micronutrientesChart');
                if (micronutrientesCtx) {
                    new Chart(micronutrientesCtx, {
                        type: 'bar',
                        data: {
                            labels: [processLabel('Selenio', 14), processLabel('Hierro', 14), processLabel('Vitamina D', 14), processLabel('Zinc', 14), processLabel('Vitamina B12', 14)],
                            datasets: [{
                                label: 'Importancia Relativa',
                                data: [90, 85, 80, 75, 70], 
                                backgroundColor: ['#FF7F50', '#008080', '#FFD700', '#FF69B4', '#ADD8E6'],
                                borderWidth: 1
                            }]
                        },
                        options: {
                            ...sharedChartOptions,
                            indexAxis: 'y',
                            scales: {
                                x: {
                                    beginAtZero: true,
                                    max: 100,
                                    ticks: { font: {size: 8} } // Reduced font size
                                },
                                y: {
                                    ticks: { font: {size: 9} } // Reduced font size
                                }
                            },
                            plugins: {
                                ...sharedChartOptions.plugins,
                                legend: { display: false }
                            }
                        }
                    });
                }
            } catch (error) {
                 console.error("Error al inicializar los gr√°ficos:", error);
            }

            // Gemini API Integration
            const getAdviceBtn = document.getElementById('getGeminiAdviceBtn');
            const geminiResponseDiv = document.getElementById('geminiResponse');
            const geminiLoader = document.getElementById('geminiLoader');

            if (getAdviceBtn) {
                getAdviceBtn.addEventListener('click', async () => {
                    const selectedConcerns = [];
                    document.querySelectorAll('input[name="concerns"]:checked').forEach((checkbox) => {
                        selectedConcerns.push(checkbox.value);
                    });

                    if (selectedConcerns.length === 0) {
                        geminiResponseDiv.innerHTML = '<p class="text-red-600">Por favor, selecciona al menos una preocupaci√≥n para obtener consejos.</p>';
                        geminiResponseDiv.classList.remove('hidden');
                        return;
                    }

                    geminiLoader.classList.remove('hidden');
                    geminiResponseDiv.classList.add('hidden');
                    geminiResponseDiv.innerHTML = ''; 

                    const prompt = `Eres un asistente virtual informativo especializado en bienestar y hipotiroidismo. Un usuario con hipotiroidismo ha expresado las siguientes preocupaciones: ${selectedConcerns.join(', ')}. 
                    Proporciona 3 o 4 consejos generales y pr√°cticos sobre dieta y estilo de vida que podr√≠an ayudar a abordar estas preocupaciones espec√≠ficas en el contexto del hipotiroidismo.
                    Cada consejo debe ser una vi√±eta (empieza con '* ').
                    Incluye una breve introducci√≥n y una conclusi√≥n enfatizando que estos son consejos generales y no sustituyen la consulta m√©dica profesional.
                    Responde en espa√±ol, en un tono amigable, emp√°tico y de apoyo. No utilices markdown para t√≠tulos o negritas.`;
                    
                    const apiKey = ""; 
                    const apiUrl = 'https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:generateContent?key=' + apiKey;
                    
                    let chatHistory = [];
                    chatHistory.push({ role: "user", parts: [{ text: prompt }] });
                    const payload = { contents: chatHistory };

                    try {
                        const response = await fetch(apiUrl, {
                            method: 'POST',
                            headers: { 'Content-Type': 'application/json' },
                            body: JSON.stringify(payload)
                        });

                        if (!response.ok) {
                            const errorData = await response.json();
                            console.error('Error de la API de Gemini:', errorData);
                            throw new Error('Error de la API: ' + response.status + ' ' + response.statusText + '. ' + (errorData?.error?.message || ''));
                        }

                        const result = await response.json();
                        
                        if (result.candidates && result.candidates.length > 0 &&
                            result.candidates[0].content && result.candidates[0].content.parts &&
                            result.candidates[0].content.parts.length > 0) {
                            
                            let rawText = result.candidates[0].content.parts[0].text;
                            let lines = rawText.split('\n'); 
                            let htmlOutput = "";
                            let inList = false;

                            for (let i = 0; i < lines.length; i++) {
                                let currentLine = lines[i].trim();

                                if (currentLine.startsWith('* ') || currentLine.startsWith('- ')) {
                                    if (!inList) {
                                        htmlOutput += "<ul>\n";
                                        inList = true;
                                    }
                                    htmlOutput += "<li>" + currentLine.substring(2) + "</li>\n";
                                } else {
                                    if (inList) {
                                        htmlOutput += "</ul>\n";
                                        inList = false;
                                    }
                                    if (currentLine !== "") {
                                        htmlOutput += "<p>" + currentLine + "</p>\n";
                                    } 
                                }
                            }

                            if (inList) { 
                                htmlOutput += "</ul>\n";
                            }
                            geminiResponseDiv.innerHTML = htmlOutput.trim();

                        } else {
                            geminiResponseDiv.innerHTML = '<p class="text-red-600">No se pudo obtener una respuesta de la IA en este momento. Por favor, int√©ntalo de nuevo m√°s tarde.</p>';
                            console.error('Respuesta inesperada de la API de Gemini:', result);
                        }
                    } catch (error) {
                        console.error('Error al llamar a la API de Gemini:', error);
                        geminiResponseDiv.innerHTML = '<p class="text-red-600">Ocurri√≥ un error al intentar obtener los consejos: ' + error.message + '. Si el error persiste, puede que la API Key no est√© configurada.</p>';
                    } finally {
                        geminiLoader.classList.add('hidden');
                        geminiResponseDiv.classList.remove('hidden');
                    }
                });
            }
        });
    </script>
</body>
</html>